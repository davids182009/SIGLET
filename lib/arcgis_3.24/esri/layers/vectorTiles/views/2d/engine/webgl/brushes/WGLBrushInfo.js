// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.24/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLBrushInfo","require exports ../../../../../core/tsSupport/extendsHelper ../GeometryUtils ./WGLBrush ../shaders/glShaderSnippets ../../../../webgl/BufferObject ../../../../webgl/Program ../../../../webgl/Texture ../../../../webgl/VertexArrayObject".split(" "),function(c,h,p,q,r,g,k,l,t,m){Object.defineProperty(h,"__esModule",{value:!0});c=function(c){function f(){var a=c.call(this)||this;a._initialized=!1;a._maxWidth=0;a._color=new Float32Array([1,
0,0,1]);return a}p(f,c);f.prototype.draw=function(a,d){var b=a.context;this._initialized||this._initialize(b);b.bindVAO(this._outlineVertexArrayObject);b.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",512);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",
this._color);b.setLineWidth(2);b.drawArrays(3,0,4);b.bindVAO();var e=this._getTexture(b,d);e&&(b.bindVAO(this._tileInfoVertexArrayObject),b.bindProgram(this._tileInfoProgram),b.bindTexture(e,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform1f("u_coord_ratio",1),this._tileInfoProgram.setUniform2f("u_delta",
8,8),this._tileInfoProgram.setUniform2f("u_dimensions",e.descriptor.width,e.descriptor.height),b.drawArrays(5,0,4),b.bindVAO())};f.prototype._initialize=function(a){if(this._initialized)return!0;var d={a_pos:0},b=new l(a,g.backgroundVS,g.backgroundFS,d),e=new l(a,g.tileInfoVS,g.tileInfoFS,d),n={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},c=new Int8Array([0,0,1,0,1,1,0,1]),c=k.createVertex(a,35044,c),c=new m(a,d,n,{geometry:c}),f=new Int8Array([0,0,1,0,0,
1,1,1]),f=k.createVertex(a,35044,f);a=new m(a,d,n,{geometry:f});this._outlineProgram=b;this._tileInfoProgram=e;this._outlineVertexArrayObject=c;this._tileInfoVertexArrayObject=a;return this._initialized=!0};f.prototype._getTexture=function(a,d){if(d.texture)return d.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));
var b=d.key.id,e=this._canvas.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="middle";var c=e.measureText(b),c=Math.pow(2,Math.ceil(q.log2(c.width+2)));c>this._maxWidth&&(this._maxWidth=c);e.clearRect(0,0,this._maxWidth,32);e.fillStyle="blue";e.fillText(b,0,16);d.texture=new t(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},this._canvas);return d.texture};return f}(r.default);h.default=c});