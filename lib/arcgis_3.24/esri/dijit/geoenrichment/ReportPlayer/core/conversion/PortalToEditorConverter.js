// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.24/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter","dojo/_base/declare dojo/promise/all dojo/when ./portalToEditorUtils/LayoutParser ./portalToEditorUtils/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/DummyVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(G,H,e,t,u,v,l,w,x,m,y,z,A){return{provideEditorJson:function(f,a){function B(){function d(b,n,d){return e(a.preProcessFile&&a.preProcessFile(b,n,c),function(C){if(!1!==C)return e(d&&d(),function(){return a.postProcessFile&&a.postProcessFile(b,n,c)})})}if(g&&g.files&&g.files){var f=a.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],q={"theme.css.txt":function(b){return d(b,"theme.css.txt",function(){c.theme=y.fromCssText(b.data,a)})},"metadata.xml":function(b){return d(b,"metadata.xml",
function(){return u.parseMetadataXML(b,c,a)})},"report.xml":function(b){return d(b,"report.xml",function(){return t.parseReportXML({isGraphicReport:p,parsers:l,file:b,templateJson:c,variableProvider:D,tableDefaultStyles:E,processFileName:k,putImageData:function(a,b){a=k(a);m.putImageData(a,b||h[a])},log:F,queryMetaDataFunc:function(b){return a.queryMetaDataFunc&&a.queryMetaDataFunc(b,c)},postProcessTableInSection:function(b,d){a.postProcessTableInSection&&a.postProcessTableInSection(c,b,d)}})})},
generic:function(a,c){return d(a,c)}},r=new z;f.forEach(function(b){var d=g.files.filter(function(a){return a.name===b})[0],c=d&&(q[b]||q.generic);c&&r.add(function(){return e(A.delay(50),function(){return c(d,b)}).otherwise(function(b){a.parseErrors.push(b);console.log(b)})})});return r.getPromise()}}a=a||{};var p=f.isGraphicReport,D=a.variableProvider=a.variableProvider||new w,E=a.tableDefaultStyles||new x;a.parseErrors=[];var c={documentOptions:{},metadata:{mapImageInfosHash:{},comparisonCalculatorsHash:{}},
theme:null};p?c.sectionsTables=[]:c.sections=[];var g=f.portalJson,h={},k=function(a){return a?a.toLowerCase():""},F=a.log||function(a){};return e(l.initialize(),function(){return e(v.collectImageResources(g,h,k),function(){for(var d in h)m.putImageData(d,h[d]);return e(B(),function(){delete c.metadata;a.parseErrors.length||(f.templateJson=c)})})})}}});